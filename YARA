YARA
YARA es un lenguaje de computación que permite a un experto en seguridad, especificar convenientemente una regla
que luego se utilizará para clasificar todas las muestras que coincidan con la regla. Una regla mínima consiste
en un nombre y una condición, por ejemplo, la siguiente:

    rule my_rule_name { condition: false }
    
Esta regla no coincidirá con ningún archivo. Por el contrario, la siguiente regla coincidirá con todas las muestras:
    
    Rule my_rule_name { condition: true }

Un ejemplo más útil será el de cualquier archivo de más de 100 KB:

    Rule over_100kb { condition: filesize > 100KB }

Otro ejemplo es comprobar si un archivo concreto es un PDF. Para ello, comprobamos si los números mágicos del archivo se 
corresponden con el PDF. Los números mágicos son una secuencia de varios bytes que se produce al principio de un archivo 
y que indica el tipo de archivo que es. En el caso de un PDF, la secuencia es 25 50 44 46:

https://filesignatures.net/index.php?page=search&search=PDF&mode=EXT

    rule is_a_pdf {
    strings:
        $pdf_magic = {25 50 44 46}
    condition:
        $pdf_magic at 0
    }

Cómo ejecutar nuestras reglas contra los archivos.

Preparación
  La preparación para esta receta consiste en instalar YARA en su dispositivo

  Instalación de YARA en Windows
  Los binarios compilados para Windows, tanto en su versión de 32 como de 64 bits, se encuentran en el siguiente enlace. 
  Sólo tiene que descargar la versión que desee, descomprimir el archivo y colocar los binarios yara.exe y yarac.exe en 
  cualquier lugar de su disco.

  descargar: https://github.com/VirusTotal/yara/releases/tag/v4.2.1

  Instalación de yara-python
  Si planea utilizar YARA desde sus scripts de Python necesita instalar la extensión yara-python. 
  Consulte https://github.com/VirusTotal/yara-python para obtener instrucciones sobre cómo instalarla.

Cómo hacerlo.
  En los siguientes pasos, le mostramos cómo crear reglas YARA y probarlas contra un archivo:
  1. Copie sus reglas, como se ve aquí, en un archivo de texto y nómbrelo rules.yara:

        rule is_a_pdf
        {
              strings:
                    $pdf_magic = {25 50 44 46}
              condition:
                    $pdf_magic at 0
        }
        rule dummy_rule1
        {
              condition:
                    false
        }
        rule dummy_rule2
        {
            condition:
                  true
        }    

  2. A continuación, seleccione un archivo con el que desee comprobar sus reglas. Llámelo archivo_objetivo. En un terminal, 
  ejecute Yara rules.yara archivo_objetivo como como sigue:
  
      Yara rule.yara PythonBrochure
      
  El resultado debería ser el siguiente:
  
      is_a_pdf target_file
      dummy_rule2 target_rule

Cómo funciona.
  Como se puede observar, en el paso 1, se ha copiado varias reglas YARA. La primera regla comprueba los números mágicos 
  de un archivo para ver si coinciden con los de un PDF. Las otras dos reglas son triviales
  triviales: una que coincide con todos los archivos y otra que no coincide con ningún archivo. 
  A continuación, en el paso 2, utilizamos el programa YARA para ejecutar las reglas contra el archivo de destino. 
  Vimos en una impresión que el archivo coincidía con algunas reglas pero no con otras, 
  como se esperaba de un conjunto de reglas YARA eficaz.
